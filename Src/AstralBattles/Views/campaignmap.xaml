<Page 
    x:Class="AstralBattles.Views.CampaignMap"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:Controls="clr-namespace:AstralBattles.Controls" xmlns:ViewModels="clr-namespace:AstralBattles.ViewModels"
    xmlns:Converters="clr-namespace:AstralBattles.Converters" FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeNormal}"
    Foreground="{StaticResource PhoneForegroundBrush}"
    mc:Ignorable="d" 
    d:DesignHeight="800" 
    d:DesignWidth="480">
    <Page.DataContext>
        <ViewModels:CampaignViewModel/>
    </Page.DataContext>

    <Page.Resources>
        <Converters:TrueToVisibleConverter x:Key="trueToVisibleConverter" />
        <Converters:FaceImageConverter x:Key="faceImageConverter" />
    </Page.Resources>
    
    <!--LayoutRoot is the root grid where all page content is placed-->
    <Grid x:Name="LayoutRoot" Background="Transparent">
        <!--ContentPanel - place additional content here-->
        <ScrollViewer HorizontalScrollBarVisibility="Visible" VerticalScrollBarVisibility="Visible" >
            <Controls:CampaignCanvas Width="1453" Height="840" Opponents="{Binding Opponents}" x:Name="canvas">
                <Controls:CampaignCanvas.Background>
                    <ImageBrush ImageSource="/AstralBattles;component/Resources/Campaign/Map1.jpg"/>
                </Controls:CampaignCanvas.Background>
            </Controls:CampaignCanvas>
        </ScrollViewer>
        <Border Visibility="{Binding IsWaitingUserChoise, Converter={StaticResource trueToVisibleConverter}}" Background="#9F808080" VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
            <Border Width="430" Background="#CD000000" VerticalAlignment="Center" CornerRadius="20" Height="Auto">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition />
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Image Width="170" Height="170" HorizontalAlignment="Left" Margin="20" 
                           Source="{Binding SelectedCampaignOpponent.Photo, Converter={StaticResource faceImageConverter}}"/>

                    <TextBlock Label="{Binding SelectedCampaignOpponent.DisplayName}" TextWrapping="Wrap" Margin="0,10,0,0" Grid.Column="1" FontSize="28" Foreground="Gold"/>
                    
                    <TextBlock Grid.Row="1" FontSize="24" Grid.ColumnSpan="2" TextWrapping="Wrap" Margin="20,0,20,0" 
                               Label="{Binding SelectedCampaignOpponent.Description}"/>
                    
                    <StackPanel Margin="10,25,10,10" HorizontalAlignment="Center" Orientation="Horizontal" Grid.ColumnSpan="2" Grid.Row="2">
                        <Button Width="170" Command="{Binding FightWithFoe}">Fight!</Button>
                        <Button Width="170" Command="{Binding CloseFoeDialog}">Close</Button>
                    </StackPanel>
                </Grid>
            </Border>
        </Border>
    </Grid>
 
</Page>
