<Page 
    x:Class="AstralBattles.Views.TournamentTable"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    
    xmlns:controls="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ViewModels="clr-namespace:AstralBattles.ViewModels" xmlns:Converters="clr-namespace:AstralBattles.Converters"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:ic="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:Controls="clr-namespace:AstralBattles.Controls" mc:Ignorable="d" d:DesignWidth="480" d:DesignHeight="696"
    FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeNormal}"
    Foreground="White" Background="Black"
    SupportedOrientations="Portrait"  Orientation="Portrait"
    >
	<Page.Resources>

        <Converters:TournamentFaceImageConverter x:Key="faceImageConverter"/>
        <Converters:TrueToGreenColorConverter x:Key="trueToGreenColorConverter"/>
        
		<DataTemplate x:Key="TotalItemDataTemplate">
			<Grid>
				<Grid.ColumnDefinitions>
					<ColumnDefinition />
					<ColumnDefinition Width="300" />
					<ColumnDefinition />
				</Grid.ColumnDefinitions>
                <Image Margin="4" Source="{Binding Name, Converter={StaticResource faceImageConverter}}" Width="45" Height="45" />
                <TextBlock Grid.Column="1" Label="{Binding Name}" Foreground="{Binding IsPlayer, Converter={StaticResource trueToGreenColorConverter}}" FontSize="38" Margin="13,0,0,0"/>
				<TextBlock Grid.Column="1" Label="{Binding Wins}" FontSize="24" Foreground="#FF707070" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0,0,13,0" FontWeight="Bold"/>
				<TextBlock Grid.Column="2" Label="{Binding Points}" FontSize="24" Foreground="#FFDAFF00" VerticalAlignment="Center"/>
			</Grid>
        </DataTemplate>

        <DataTemplate x:Key="RoundResultDataTemplate">
            <Grid>
            <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="140" />
                    <ColumnDefinition />
                    <ColumnDefinition Width="40" />
                    <ColumnDefinition />
                    <ColumnDefinition Width="140"/>
                </Grid.ColumnDefinitions>
                <Image Margin="4" Source="{Binding Item1, Converter={StaticResource faceImageConverter}}" 
					   Grid.Column="1" Width="50" Height="50" />
                <Image Margin="4" Source="{Binding Item2, Converter={StaticResource faceImageConverter}}" 
					   Grid.Column="3" Width="50" Height="50" />
                <TextBlock Grid.Column="0" Label="{Binding Item1}" 
						   HorizontalAlignment="Right" 
						   VerticalAlignment="Center"
						   FontSize="24" Margin="0,0,10,0" Foreground="#FFEDFF46"/>
                <TextBlock Grid.Column="4" Label="{Binding Item2}"
						   VerticalAlignment="Center" Foreground="White"
						   FontSize="24" Margin="10,0,0,0"/>
                <TextBlock Grid.Column="2" Label=">"
						   VerticalAlignment="Center"
						   FontSize="24" Margin="12,0,0,0" Foreground="White" FontWeight="Bold"/>
            </Grid>
        </DataTemplate>

        <DataTemplate x:Key="NextRoundDataTemplate">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="140" />
                    <ColumnDefinition />
                    <ColumnDefinition Width="40" />
                    <ColumnDefinition />
                    <ColumnDefinition Width="140"/>
                </Grid.ColumnDefinitions>
                <Image Margin="4" Source="{Binding Item1, Converter={StaticResource faceImageConverter}}" 
					   Grid.Column="1" Width="50" Height="50" />
                <Image Margin="4" Source="{Binding Item2, Converter={StaticResource faceImageConverter}}" 
					   Grid.Column="3" Width="50" Height="50" />
                <TextBlock Grid.Column="0" Label="{Binding Item1}" 
						   HorizontalAlignment="Right"
						   VerticalAlignment="Center" Foreground="White"
						   FontSize="24" Margin="0,0,10,0"/>
                <TextBlock Grid.Column="4" Label="{Binding Item2}"
						   VerticalAlignment="Center" Foreground="White"
						   FontSize="24" Margin="10,0,0,0"/>
                <TextBlock Grid.Column="2" Label="vs"
						   VerticalAlignment="Center"
						   FontSize="24" Margin="10,0,0,0" Foreground="#FF9B9B9B"/>
            </Grid>
        </DataTemplate>



        <Style x:Key="ListBoxItemStyle" TargetType="ListBoxItem">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="BorderBrush" Value="Transparent"/>
			<Setter Property="Padding" Value="0"/>
			<Setter Property="HorizontalContentAlignment" Value="Left"/>
			<Setter Property="VerticalContentAlignment" Value="Top"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="ListBoxItem">
						<Border x:Name="LayoutRoot" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" VerticalAlignment="{TemplateBinding VerticalAlignment}">
							<VisualStateManager.VisualStateGroups>
								<VisualStateGroup x:Name="CommonStates">
									<VisualState x:Name="Normal"/>
									<VisualState x:Name="MouseOver"/>
									<VisualState x:Name="Disabled">
										<Storyboard>
											<ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="LayoutRoot">
												<DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource TransparentBrush}"/>
											</ObjectAnimationUsingKeyFrames>
											<DoubleAnimation Duration="0" To=".5" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="ContentContainer"/>
										</Storyboard>
									</VisualState>
								</VisualStateGroup>
								<VisualStateGroup x:Name="SelectionStates">
									<VisualState x:Name="Unselected"/>
									<VisualState x:Name="Selected">
										<Storyboard>
											<ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="ContentContainer">
												<DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource PhoneAccentBrush}"/>
											</ObjectAnimationUsingKeyFrames>
										</Storyboard>
									</VisualState>
									<VisualState x:Name="SelectedUnfocused"/>
								</VisualStateGroup>
							</VisualStateManager.VisualStateGroups>
							<ContentControl x:Name="ContentContainer" ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" Foreground="{TemplateBinding Foreground}" HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"/>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>
	</Page.Resources>
    <Page.DataContext>
        <ViewModels:StatisticsViewModel/>
    </Page.DataContext>


    <Controls:BusyIndicatorControl 
        IsBusy="{Binding IsBusy}" 
        Foreground="White"
        BusyLabel="{Binding CommonResources.Loading, Source={StaticResource ResourceWrapper}}"
        Style="{StaticResource BusyIndicatorStyle}"
        HideApplicationBar="True">
        <!--LayoutRoot is the root grid where all page content is placed-->
    <Grid x:Name="LayoutRoot" Background="Black">
        <!--Pivot Control-->
        <controls:Pivot Title="{Binding Resources.CommonResources.Title}" Foreground="White">
            <!--Pivot item one-->
            <controls:PivotItem Header="{Binding RoundName}">
                <Grid>
                    <ListBox ItemsSource="{Binding RoundResult}" 
							 ItemTemplate="{StaticResource RoundResultDataTemplate}"
							 ScrollViewer.VerticalScrollBarVisibility="Disabled" 
							 ItemContainerStyle="{StaticResource ListBoxItemStyle}">
                    </ListBox>
                </Grid>
            </controls:PivotItem>

            <!--Pivot item two-->
            <controls:PivotItem Header="{Binding Resources.CommonResources.Total}">
                <Grid>
                    <ListBox ItemsSource="{Binding Total}" 
							 ItemTemplate="{StaticResource TotalItemDataTemplate}"
							 ScrollViewer.VerticalScrollBarVisibility="Disabled" 
                             ItemContainerStyle="{StaticResource ListBoxItemStyle}">
                    </ListBox>
                </Grid>
            </controls:PivotItem>
            <controls:PivotItem Header="{Binding Resources.CommonResources.NextGame}">
                <Grid>
                    <ListBox ItemsSource="{Binding NextRound}" 
							 ItemTemplate="{StaticResource NextRoundDataTemplate}"
							 ScrollViewer.VerticalScrollBarVisibility="Disabled" 
                             ItemContainerStyle="{StaticResource ListBoxItemStyle}">
                    </ListBox>
                </Grid>
            </controls:PivotItem>
        </controls:Pivot>
    </Grid>
        </Controls:BusyIndicatorControl>

    <!--Sample code showing usage of ApplicationBar-->
    <Page.ApplicationBar>
        <CommandBar IsVisible="True" IsMenuEnabled="True">
            <CommandBarIconButton x:Name="appbarNext" Icon="/icons/appbar.next.rest.png" Label="Next game">
                <i:Interaction.Behaviors>
                    <ic:EventTriggerBehavior EventName="Click">
                        <ic:InvokeCommandAction Command="{Binding StartNewRound}" />
                    </ic:EventTriggerBehavior>
                </i:Interaction.Behaviors>
            </CommandBarIconButton>
        </CommandBar>
    </Page.ApplicationBar>
    
</Page>